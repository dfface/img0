(()=>{"use strict";var t={151:(t,e)=>{function i(t,e){if(void 0===t)throw new Error(`${null!=e?e:"Value"}is undefined`);return t}function r(t,e){if(null===t)throw new Error(`${null!=e?e:"Value"}is null`);return t}e.ensureNotNull=void 0,e.ensureNotNull=r}};var e={};function i(r){var s=e[r];if(void 0!==s)return s.exports;var n=e[r]={exports:{}};return t[r](n,n.exports,i),n.exports}(()=>{var t=i(151);const e={"color-cold-gray-300":"#B2B5BE","color-brand":"#2962FF","color-brand-hover":"#1E53E5","color-brand-active":"#1848CC"};const r=JSON.parse('{"crypto-mkt-screener":{"width":1000,"height":490,"defaultColumn":"overview","market":"crypto","screener_type":"crypto_mkt","displayCurrency":"USD","isTransparent":false},"events":{"width":510,"height":600,"isTransparent":false,"hideImportanceIndicator":false,"autosize":false},"forex-cross-rates":{"width":770,"height":400,"isTransparent":false,"currencies":["EUR","USD","JPY","GBP","CHF","AUD","CAD","NZD"],"frameElementId":null,"autosize":false},"forex-heat-map":{"width":770,"height":400,"isTransparent":false,"currencies":["EUR","USD","JPY","GBP","CHF","AUD","CAD","NZD","CNY"],"frameElementId":null,"autosize":false},"hotlists":{"width":400,"height":600,"isTransparent":false,"dateRange":"12M","showSymbolLogo":false},"market-overview":{"width":400,"height":650,"isTransparent":false,"dateRange":"12M","showSymbolLogo":true},"market-quotes":{"width":770,"height":450,"isTransparent":false,"showSymbolLogo":false},"mini-symbol-overview":{"width":350,"height":220,"symbol":"FX:EURUSD","dateRange":"12M","isTransparent":false,"autosize":false,"largeChartUrl":""},"symbol-overview":{"width":1000,"height":500,"symbols":[["Apple","AAPL|1D"],["Google","GOOGL|1D"],["Microsoft","MSFT|1D"]],"autosize":false,"chartOnly":false,"hideDateRanges":false,"hideMarketStatus":false,"hideSymbolLogo":false,"scalePosition":"right","scaleMode":"Normal","fontFamily":"-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif","fontSize":"10","noTimeScale":false,"chartType":"area","valuesTracking":"0","changeMode":"price-and-percent"},"advanced-chart":{"bodyId":"widget-container","bodyClasses":["chart-page","unselectable","on-widget"]},"screener":{"width":1100,"height":523,"defaultColumn":"overview","defaultScreen":"general","market":"forex","showToolbar":true,"isTransparent":false},"single-quote":{"width":350,"symbol":"FX:EURUSD","isTransparent":false},"symbol-profile":{"width":480,"height":650,"symbol":"NASDAQ:AAPL","isTransparent":false},"symbol-info":{"width":1000,"symbol":"NASDAQ:AAPL","isTransparent":false},"technical-analysis":{"interval":"1m","width":425,"isTransparent":false,"height":450,"symbol":"NASDAQ:AAPL","showIntervalTabs":true,"displayMode":"single"},"ticker-tape":{"isTransparent":false,"displayMode":"adaptive","showSymbolLogo":false},"tickers":{"isTransparent":false,"showSymbolLogo":false},"financials":{"width":480,"height":830,"autosize":false,"symbol":"NASDAQ:AAPL","isTransparent":false,"displayMode":"regular","largeChartUrl":""},"timeline":{"width":480,"height":830,"autosize":false,"isTransparent":false,"displayMode":"regular","feedMode":"all_symbols"},"stock-heatmap":{"width":500,"height":500,"autosize":true,"dataSource":"SPX500","exchanges":[],"grouping":"sector","blockSize":"market_cap_basic","blockColor":"change","hasTopBar":false,"isDataSetEnabled":false,"isZoomEnabled":true,"hasSymbolTooltip":true,"symbolUrl":"","isMonoSize":false},"crypto-coins-heatmap":{"width":500,"height":500,"autosize":true,"dataSource":"Crypto","blockSize":"market_cap_calc","blockColor":"24h_close_change|5","hasTopBar":false,"isDataSetEnabled":false,"isZoomEnabled":true,"hasSymbolTooltip":true,"symbolUrl":"","isMonoSize":false},"etf-heatmap":{"width":500,"height":500,"autosize":true,"dataSource":"AllUSEtf","blockSize":"volume","blockColor":"change","grouping":"asset_class","hasTopBar":false,"isDataSetEnabled":false,"isZoomEnabled":true,"hasSymbolTooltip":true,"symbolUrl":"","isMonoSize":false}}');var s,n;!function(t){let e;!function(t){t.SetSymbol="set-symbol",t.SetInterval="set-interval"}(e=t.Names||(t.Names={}))}(s||(s={})),function(t){let e;!function(t){t.SymbolClick="tv-widget-symbol-click",t.WidgetLoad="tv-widget-load",t.WidgetReady="tv-widget-ready",t.ResizeIframe="tv-widget-resize-iframe",t.NoData="tv-widget-no-data"}(e=t.Names||(t.Names={}))}(n||(n={}));const o="__FAIL__",a="__NHTTP__",l=new RegExp("^http(s)?:(//)?");function h(t=location.href){const e=function(t){try{const e=new URL(t);return l.test(e.protocol)?null:a}catch(t){return o}}(t);return e||t.replace(l,"")}const c="https://www.tradingview-widget.com",d="BATTLE";const u=["locale","symbol","market"];class g{constructor(customConfig={}){this._copyrightContainer=null;this._customConfig={containerSelector:"#tradingview-chart",width:"100%",height:"500px",autosize:false,...customConfig};this._defaultScriptURL={host:"www.tradingview-widget.com",pathname:"/embed-widget/advanced-chart/",href:c,protocol:"https:"};this._initWidget()}_initWidget(){const{containerSelector,overrideHost,...chartSettings}=this._customConfig;this.settings={...this.defaultSettings,...chartSettings};if(!this._validateSettings()){this.settings.width="100%";this.settings.height="500px"}this.iframeContainer=document.querySelector(containerSelector);if(!this.iframeContainer){console.warn(`容器${containerSelector}不存在，创建默认容器`);this.iframeContainer=document.createElement("div");this.iframeContainer.id="tradingview-chart-default";document.body.appendChild(this.iframeContainer)}this._renderIframe(overrideHost||c)}_renderIframe(host){const f="32px";const{width,height}=this.settings;this.iframeContainer.style.width=width;this.iframeContainer.style.height=height;this.iframeContainer.style.position="relative";this._addCopyrightStyles();const _=this.hasCopyright()?`calc(100%-${f})`:"100%";const k=`${this.widgetId.replace("-"," ")}TradingView widget`;const I=this.settings.locale||"zh_CN";this.iframe=this._createIframe(_,host,null,k,I);this.iframeContainer.appendChild(this.iframe);this._listenToIframeResize()}_addCopyrightStyles(){const style=document.createElement("style");style.innerHTML=`.tradingview-widget-copyright{font-size:13px!important;line-height:32px!important;text-align:center!important;vertical-align:middle!important;font-family:-apple-system,BlinkMacSystemFont,'Trebuchet MS',Roboto,Ubuntu,sans-serif!important;color:${e["color-cold-gray-300"]}!important}.tradingview-widget-copyright.blue-text{color:${e["color-brand"]}!important}.tradingview-widget-copyright a{text-decoration:none!important;color:${e["color-cold-gray-300"]}!important}.tradingview-widget-copyright a:hover.blue-text{color:${e["color-brand-hover"]}!important}.tradingview-widget-copyright a:active.blue-text{color:${e["color-brand-active"]}!important}`;this.iframeContainer.appendChild(style)}_renderCopyright(){if(this.hasCopyright())return;const copyrightDiv=document.createElement("div");copyrightDiv.className="tradingview-widget-copyright";copyrightDiv.innerHTML='<a href="https://www.tradingview.com/" rel="noopener noreferrer" target="_blank"><span class="blue-text">TradingView</span> 提供的数据</a>';this.iframeContainer.appendChild(copyrightDiv);this._copyrightContainer=copyrightDiv}_listenToIframeResize(){if(!this.shouldListenToIframeResize||!this.iframe)return;const r=this.iframe.contentWindow;if(!r)return console.warn("iframe contentWindow 暂不可用，跳过resize监听");function s(e){e.source&&e.source===r&&e.data&&e.data.name&&e.data.name===n.Names.ResizeIframe&&(e.data.data.width&&(this.iframe.style.width=e.data.data.width+"px"),this.iframe.style.height=e.data.data.height+"px")}window.addEventListener("message",s.bind(this),!1)}_validateSettings(){try{const validateDimension=(val,defaultValue)=>{if(!val)return defaultValue;const strVal=String(val);return/^\d+$/.test(strVal)||/^(\d+%|auto)$/.test(strVal)?val:defaultValue};this.settings.width=validateDimension(this.settings.width,"100%");this.settings.height=validateDimension(this.settings.height,"500px");return true}catch(err){console.warn("配置验证失败，使用默认值：",err);return false}}_createIframe(t,e,i,r,s){const n=document.createElement("iframe");i&&(n.id=i);n.setAttribute("allowtransparency","true");n.setAttribute("frameborder","0");n.style.userSelect="none";n.style.boxSizing="border-box";n.style.display="block";n.style.height=t;n.style.width="100%";n.title=r;n.lang=s;const o=new URL(this._iframeSrcBase(e));this._setSettingsQueryString(o);this._setHashString(o,i);n.setAttribute("src",o.toString());return n}_iframeSrcBase(t){return`${t}/embed-widget/${this.widgetId}/`}_setSettingsQueryString(t){const e=this.propertiesToAddToGetParams.filter((t=>-1!==u.indexOf(t)));const i=Object.fromEntries(e.map(key=>[key,this.settings[key]]).filter(([_,val])=>val));for(const[key,val]of Object.entries(i))t.searchParams.append(key,val)}_setHashString(t,e){const i={...this.settings,frameElementId:e};(this.useParamsForConnectSocket||this.useSnowplowPageView)&&(i["page-uri"]=h());t.hash=encodeURIComponent(JSON.stringify(i))}get widgetId(){return"advanced-chart"}get defaultSettings(){return r[this.widgetId]||{}}get propertiesToWorkWith(){return["symbol","interval","locale","width","height","autosize"]}get useParamsForConnectSocket(){return true}get useSnowplowPageView(){return false}get shouldListenToIframeResize(){return true}get propertiesToSkipInHash(){return["customer","locale"]}get propertiesToAddToGetParams(){return["locale"]}hasCopyright(){return!!this._copyrightContainer}}window.initTradingViewAdvancedChart=function(customConfig={}){return new class extends g{get widgetId(){return"advanced-chart"}get propertiesToWorkWith(){return["containerSelector","symbol","interval","timezone","theme","style","locale","allow_symbol_change","backgroundColor","gridColor","autosize","width","height","hide_top_toolbar"]}}(customConfig)}})()})();
